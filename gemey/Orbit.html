<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="css/style.css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery-3.1.1.js"></script>
    <!--<script src="js/main.js"></script>-->
</head>
<body>
    <div class="point">
        <div id="containerId" class="container">
            <div class="PlaygroundChild">
                <div class="PlaygroundGrandChild">
                    <div class="PlaygroundDestroy"></div>
                </div>
            </div>

        </div>
    </div>
        <script>

            $(document).ready(function () {

                //--------------------------- Global Variables
                var sessionTime = 0;//time for Round, 3 minutes by default, per/sec
                var myShipObj;
                var sleepHealthArray = [];
                var movableHealthArray = [];
                var triangleHeathArray = [];
                var sleepEnemyArray = [];
                var movableEnemyArray = [];
                var trackerEnemyArray = [];
                //--------------------------- BaseComponent Class
                function BaseComponent() {
                    this.X = 0;
                    this.Y = 0;
                    this.Id = "";        //reflect in css as (<div id="classType_indexOfArrary">)
                    this.LifeTime = 1;
                    this.Type = ""; // (player,Enemy,Health) reserved
                    this.Radious = 0;
                    this.Direction = 0;    //1:clockwise   -1:anticlockwise    0:sleep
                    this.ClassType = ""    //reflect on css
                    this.Width = 0;     //width:Height: no link with css just mirror from css
                    this.Height = 0;
                    this.Create = function () {
                        var newDiv = document.createElement("div");
                        $(newDiv).attr("class", this.ClassType);
                        $(newDiv).attr("id", this.Id);
                        $(newDiv).css("left", (this.X));
                        $(newDiv).css("top", (this.Y));
                        //for Demo: Delete object and element when hover it
                        $(newDiv).on("mouseover", function () {
                            console.log("position of deleted Object X: " + parseInt($(this).position().left) + " Y: " + parseInt($(this).position().top));
                            var id = $(this).attr("id");
                            var objectType = id.split("_");
                            switch (objectType[0]) {
                                case "myship":
                                    console.log("You can't Delete myShip Object");
                                    break;
                                case "sleepHealth":
                                    if (objectType[1] < sleepHealthArray.length && sleepHealthArray[objectType[1]] != "del") {
                                        sleepHealthArray[objectType[1]].Destroy();//to delete element form container (div)
                                        sleepHealthArray[objectType[1]] = "del";//to replace object with new one in array
                                    } else if (objectType[1] >= sleepHealthArray.length) {
                                        $(this).remove();
                                    }
                                    break;
                                case "movableHealth":
                                    if (objectType[1] < movableHealthArray.length && movableHealthArray[objectType[1]] != "del") {
                                        movableHealthArray[objectType[1]].Destroy();//to delete element form container (div)
                                        movableHealthArray[objectType[1]] = "del";//to replace object with new one in array
                                    } else if (objectType[1] >= movableHealthArray.length) {
                                        $(this).remove();
                                    }
                                    break;
                                case "triangleHealth":
                                    if (objectType[1] < triangleHeathArray.length && triangleHeathArray[objectType[1]] != "del") {
                                        triangleHeathArray[objectType[1]].Destroy();//to delete element form container (div)
                                        triangleHeathArray[objectType[1]] = "del";//to replace object with new one in array
                                    } else if (objectType[1] >= triangleHeathArray.length) {
                                        $(this).remove();
                                    }
                                    break;
                                case "sleepEnemy":
                                    if (objectType[1] < sleepEnemyArray.length && sleepEnemyArray[objectType[1]] != "del") {
                                        sleepEnemyArray[objectType[1]].Destroy();//to delete element form container (div)
                                        sleepEnemyArray[objectType[1]] = "del";//to replace object with new one in array
                                    } else if (objectType[1] >= sleepEnemyArray.length) {
                                        $(this).remove();
                                    }
                                    break;
                                case "movableEnemy":
                                    if (objectType[1] < movableEnemyArray.length && movableEnemyArray[objectType[1]] != "del") {
                                        movableEnemyArray[objectType[1]].Destroy();//to delete element form container (div)
                                        movableEnemyArray[objectType[1]] = "del";//to replace object with new one in array
                                    } else if (objectType[1] >= movableEnemyArray.length) {
                                        $(this).remove();
                                    }
                                    break;

                                default:

                            }
                        });
                        $("#containerId").append(newDiv);
                    }
                    this.Destroy = function () {
                        //remove div element by Id
                        $("#" + this.Id).remove();
                        //delet object from memroy
                        delete this;
                    }
                }
                //-------


                //--------------------------- MyShip Class
                function MyShip(_x, _y, _direction) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "myship_1";   //constant class in css
                    this.LifeTime = 0;
                    this.Type = "player"; //reserved
                    this.Radious = 0;
                    this.Direction = _direction;
                    this.ClassType = "myship";
                    this.Width = 10;
                    this.Height = 35;
                } MyShip.prototype = new BaseComponent;

                //--------------------------- Enemy Classes
                //-------------Sleep Enemy Class
                function SleepEnemy(_x, _y, _index, _radius) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "sleepEnemy_" + _index;
                    this.LifeTime = 15;//default 15 sec
                    this.Type = "Enemy";//reserved
                    this.Radious = _radius;
                    this.Direction = 0;//he is not moving
                    this.ClassType = "sleepenemy";
                    this.Width = 17;
                    this.Height = 17;
                } SleepEnemy.prototype = new BaseComponent;
                //-------------Movable Enemy Class
                function MovableEnemy(_x, _y, _index, _radius, _direction) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "movableEnemy_" + _index;
                    this.LifeTime = 15;  //1:still not reach to center 0:reach to center
                    this.Type = "Enemy";//reserved
                    this.Radious = _radius;
                    this.Direction = _direction;
                    this.ClassType = "movableenemy";
                    this.Width = 12;
                    this.Height = 12;
                    this.Move = function () {
                        //will move in virsual circle randomly
                    }
                } MovableEnemy.prototype = new BaseComponent;
                //-------------Tracker Enemy Class
                function TrackerEnemy(_x, _y, _index, _lifeTime, _radius, _direction) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "trackerEnemy_" + _index;
                    this.LifeTime = _lifeTime;
                    this.Type = "Enemy";//reserved
                    this.Radious = _radius;
                    this.Direction = _direction;
                    this.ClassType = "";
                    this.Width = 6;
                    this.Height = 30;
                    this.TrackShipPlayer = function () {
                        //will track ship player in constant speed
                    }
                } TrackerEnemy.prototype = new BaseComponent;

                //--------------------------- Health Classes
                //-------------Sleep Health Class
                function SleepHealth(_x, _y, _index, _radius) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "sleepHealth_" + _index;
                    this.LifeTime = 15;     //default 15 sec
                    this.Type = "Health";   //reserved
                    this.Radious = _radius;
                    this.Direction = 0;     //he is not moving
                    this.ClassType = "sleephealth";
                    this.Width = 24;
                    this.Height = 24;
                } SleepHealth.prototype = new BaseComponent;
                //-------------Movable Health Class
                function MovableHealth(_x, _y, _index, _radius, _direction) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "movableHealth_" + _index;
                    this.LifeTime = 1;  //1:still not reach to center 0:reach to center
                    this.Type = "Health";//reserved
                    this.Radious = _radius; //radius form center
                    this.Direction = _direction;
                    this.ClassType = "movablehelath";
                    this.Width = 12;
                    this.Height = 24;
                    this.Move = function () {
                        //will move in spiral move to center same way of myShip object
                        ElementRevolver.start(this, {
                            radius: this.Radious,
                            center: { x: container.X, y: container.Y },
                            // direction = 1 for clockwise, -1 for counterclockwise
                            direction: 1,
                            // startPosition can be a degree angle
                            // (0:360) random degree angle 
                            startPositionDeg: GetRandomNumber(0,360),
                            // when raius reduce to 20 it will stop
                            stopRadius: 20,
                            // Time for complete one circle
                            intervalOneCircle: 10000,
                            //time for speral interval : reducing time
                            intervalSperal: 60,
                            // how often (in milliseconds) the position of the
                            // circle should be attempted to be updated
                            updateInterval: 50
                        });
                    }
                } MovableHealth.prototype = new BaseComponent;
                //-------------Triangle Health Class
                function TriangleHealth(_x, _y, _index, _radius, _direction) {
                    this.X = _x;
                    this.Y = _y;
                    this.Id = "triangleHealth_" + _index;
                    this.LifeTime = 15;
                    this.Type = "Health";//reserved
                    this.Radious = _radius;
                    this.Direction = _direction;
                    this.ClassType = "trianglehealth";
                    this.Width = 38;
                    this.Height = 20;
                    this.Move = function () {
                        //will move in virsual circle randomly.
                    }
                } TriangleHealth.prototype = new BaseComponent;


                //----------------------------------------- Container Object
                //
                //container center (x,y) and radius
                //detect collision in container for all objects every 100 interval
                var container = {
                    X: parseInt(($("#containerId").width()) / 2),
                    Y: parseInt(($("#containerId").height()) / 2),
                    radius: parseInt(($("#containerId").width()) / 2),
                    RoundTime: 0,
                    CreatCenter: function () {
                        var newDiv = document.createElement("div");
                        $(newDiv).attr("class", "divCenter");
                        $(newDiv).attr("id", "idDivCenter");
                        $(newDiv).css("left", (this.X - 27)); //27:radius of divcenter
                        $(newDiv).css("top", (this.Y - 27));
                        $("#containerId").append(newDiv);
                    },
                    DetectCollision: function () {
                        //here where conatainer detect if collision happen
                        //get Position Myship Object
                        var myleft = myShipObj.X;
                        var myright = myleft + myShipObj.Width;
                        var mytop = myShipObj.Y;
                        var mybottom = mytop + myShipObj.Height;

                        //Loop for sleep Health
                        for (var i = 0; i < sleepHealthArray.length; i++) {
                            if (sleepHealthArray[i] != "del") {
                                var objleft = sleepHealthArray[i].X;
                                var objright = objleft + sleepHealthArray[i].Width;
                                var objtop = sleepHealthArray[i].Y;
                                var objbottom = objtop + sleepHealthArray[i].Height;
                                if (!(mybottom < objtop || mytop > objbottom ||
                                    myleft > objright || myright < objleft)) {
                                    console.log("collision sleep health");
                                    //collision happen
                                    //check first as this interval faster than SessionInterval
                                    sleepHealthArray[i].Destroy(); //to delete element form container (div)
                                    sleepHealthArray[i] = "del";  //to replace object with new one in array.
                                }
                            }
                        }

                        //loop for movable health
                        for (var i = 0; i < movableHealthArray.length; i++) {
                            if (movableHealthArray[i] != "del") {
                                var objleft = movableHealthArray[i].X;
                                var objright = objleft + movableHealthArray[i].Width;
                                var objtop = movableHealthArray[i].Y;
                                var objbottom = objtop + movableHealthArray[i].Height;
                                if (!(mybottom < objtop || mytop > objbottom ||
                                    myleft > objright || myright < objleft)) {
                                    console.log("collision Movable health");
                                    //collision happen
                                    //check first as this interval faster than SessionInterval
                                    movableHealthArray[i].Destroy(); //to delete element form container (div)
                                    movableHealthArray[i] = "del";  //to replace object with new one in array.
                                }
                            }
                        }

                        //loop for triangle health
                        for (var i = 0; i < triangleHeathArray.length; i++) {
                            if (triangleHeathArray[i] != "del") {
                                var objleft = triangleHeathArray[i].X;
                                var objright = objleft + triangleHeathArray[i].Width;
                                var objtop = triangleHeathArray[i].Y;
                                var objbottom = objtop + triangleHeathArray[i].Height;
                                if (!(mybottom < objtop || mytop > objbottom ||
                                    myleft > objright || myright < objleft)) {
                                    console.log("collision triangle health");
                                    //collision happen
                                    //check first as this interval faster than SessionInterval
                                    triangleHeathArray[i].Destroy(); //to delete element form container (div)
                                    triangleHeathArray[i] = "del";  //to replace object with new one in array.
                                }
                            }
                        }

                        //Loop for sleep Enemy
                        for (var i = 0; i < sleepEnemyArray.length; i++) {
                            if (sleepEnemyArray[i] != "del") {
                                var objleft = sleepEnemyArray[i].X;
                                var objright = objleft + sleepEnemyArray[i].Width;
                                var objtop = sleepEnemyArray[i].Y;
                                var objbottom = objtop + sleepEnemyArray[i].Height;
                                if (!(mybottom < objtop || mytop > objbottom ||
                                    myleft > objright || myright < objleft)) {
                                    console.log("collision sleep Enemy");
                                    //collision happen
                                    //check first as this interval faster than SessionInterval
                                    sleepEnemyArray[i].Destroy(); //to delete element form container (div)
                                    sleepEnemyArray[i] = "del";  //to replace object with new one in array.
                                }
                            }
                        }

                        //loop for movable enemy
                        for (var i = 0; i < movableEnemyArray.length; i++) {
                            if (movableEnemyArray[i] != "del") {
                                var objleft = movableEnemyArray[i].X;
                                var objright = objleft + movableEnemyArray[i].Width;
                                var objtop = movableEnemyArray[i].Y;
                                var objbottom = objtop + movableEnemyArray[i].Height;
                                if (!(mybottom < objtop || mytop > objbottom ||
                                    myleft > objright || myright < objleft)) {
                                    console.log("collision Movable enemy");
                                    //collision happen
                                    //check first as this interval faster than SessionInterval
                                    movableEnemyArray[i].Destroy(); //to delete element form container (div)
                                    movableEnemyArray[i] = "del";  //to replace object with new one in array.
                                }
                            }
                        }


                        //loop for tracker enemy
                    },
                    UpdateContainer: function () {
                        var detectInterval = setInterval(function () {
                            //Detect collision
                            container.DetectCollision();

                            //Update Movable Ojbects


                        }, 50);
                        //stop interval when game stope
                        setTimeout(function () {
                            clearInterval(detectInterval);
                        }, (container.RoundTime * 1000));

                    }
                };
                

                //-----------------------------------------------------help Functions
                //--------------- Get random Point in Circle
                function GetRandomPoint(centerX, centerY, MaxRadius, MinRadius) {
                    var x, y;
                    do {
                        var x = GetRandomNumber(centerX - MaxRadius, centerX + MaxRadius);
                        var y = GetRandomNumber(centerY - MaxRadius, centerY + MaxRadius);
                        var distance = Math.sqrt(Math.pow((centerX - x), 2) + Math.pow((centerY - y), 2));//distance between point and center
                    } while (distance > MaxRadius || distance < MinRadius);
                    return { X: x, Y: y, Radius: distance };
                }
                function GetRandomNumber(min, max) {
                    return Math.floor(Math.random() * (max - min) + min);       //min (inclusive) and max (exclusive)
                }
                //--------------- Get Game Level
                //Devide The Game to Three Levels by devide sessionTime to 3 parts
                function GetGameLevel() {
                    var partTime = parseInt(container.RoundTime / 3);
                    var Level = 0;
                    //First Level
                    if (sessionTime > (partTime * 2)) {
                        Level = 1;
                    }
                        //Second Level
                    else if (sessionTime > partTime) {
                        Level = 2;
                    }
                        //Third Level
                    else if (sessionTime > 0) {
                        Level = 3;
                    }
                    return Level;
                }
                //--------------- MyException
                function MyException(message) {
                    this.message = message;
                    this.name = "MyException";
                }

                //---------------------------- moving functions
                var ElementRevolver = (function () {
                   
                    function getPosition(settings, ellapsedTime) {
                        var angle = getAngle(settings, ellapsedTime);
                        return {
                            x: Math.round(settings.center.x + settings.radius * Math.cos(angle)),
                            y: Math.round(settings.center.y + settings.radius * Math.sin(angle))
                        };
                    }

                    function getAngle(settings, ellapsedTime) {
                        return ellapsedTime / settings.intervalOneCircle * 2 * Math.PI * settings.direction - settings.startPositionRad;
                    }

                    function start(obj, settings) {
                        var el = document.getElementById(obj.Id),
                            startTime = (new Date()).getTime(),
                            width = el.offsetWidth,
                            height = el.offsetHeight;
                        //el.style.position = settings.cssPosition || 'absolute';
                        if (!settings.startPositionRad) settings.startPositionRad = settings.startPositionDeg / 180 * Math.PI;

                        // -----------  ----------------- circle move every 50 ms
                        el['intervalCircleMove'] = setInterval(function () {
                            var pos = getPosition(settings, (new Date()).getTime() - startTime);
                            var x=pos.x - Math.round(width / 2);
                            var y=pos.y - Math.round(height / 2);
                            el.style.left = x + 'px';
                            el.style.top = y + 'px';
                            obj.X = x;
                            obj.Y = y;
                        }, settings.updateInterval);

                        // -----------  -----------------  speral move set interval every 2000 ms
                        el['intervalSperal'] = setInterval(function () {
                            if (settings.radius < settings.stopRadius) {
                                stopIntervals(el);
                                obj.Radious = settings.radius;
                                //console.log(obj);
                            } else {
                                settings.radius--;
                            }
                            //console.log(settings.radius);
                        }, settings.intervalSperal);
                    }
                    function stopIntervals(el) {
                        clearInterval(el['intervalSperal']);
                        clearInterval(el['intervalCircleMove']);
                    }
                    return {
                        start: start
                    };
                })();
                //------------end moving functions


                //-----------------------------------Objects Functionality
                //
                //-------------------My Ship Object
                function CreateMyShip(noOfShip) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 30, container.radius - 232);
                    myShipObj = new MyShip(pos.X, pos.Y, 1);
                    myShipObj.Create();
                }


                //--------Sleep health Objects
                function CreateSleephealthObject(index) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 40, container.radius - 232);
                    var obj = new SleepHealth(pos.X, pos.Y, index, pos.Radius);
                    //setTimeout(function () {
                    //    obj.Create();
                    //}, GetRandomNumber(1,10)*300);  //to prevent create objects in same time
                    obj.Create();   //did't use set time out as the different in two interval time squence
                    return obj;
                }
                function ManageSleepHealthObjects(LevelObjectsNO) {
                    //fill array if the length less Number of Objects in level
                    if (sleepHealthArray.length < LevelObjectsNO) {
                        for (var i = sleepHealthArray.length ; i < LevelObjectsNO; i++) {
                            sleepHealthArray[i] = CreateSleephealthObject(i);
                        }
                    } else {
                        for (var i = LevelObjectsNO; i < sleepHealthArray.length; i++) {
                            if (sleepHealthArray[i] != "del") {
                                sleepHealthArray[i].Destroy();
                            }
                        }
                    }
                    sleepHealthArray.length = LevelObjectsNO;
                    for (var i = 0; i < sleepHealthArray.length; i++) {
                        //decrease LifTime every Second
                        sleepHealthArray[i].LifeTime--;
                        //check if lifetime <0 destroy this Object
                        if (sleepHealthArray[i].LifeTime <= 0) {
                            sleepHealthArray[i].Destroy();      //destroy this object
                            sleepHealthArray[i] = CreateSleephealthObject(i);//Create new Object in same index
                        } else if (sleepHealthArray[i] == "del") {
                            //replace "del" keyword to New Object
                            //"del" assign to this object in case he Hit Myship
                            //he already had been destroyed in collision Function
                            sleepHealthArray[i] = CreateSleephealthObject(i);
                        }
                    }
                }
                //------- End

                //--------Movable health Objects
                function CreateMovableHealthObject(index) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    //10: width of object no paypass circle ,50: this object appear in Outer Orbit
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 10, container.radius - 50);
                    var obj = new MovableHealth(pos.X, pos.Y, index, pos.Radius, 1);
                    obj.Create();
                    obj.Move();
                    return obj;
                }
                function ManageMovableHealthObjects(LevelObjectsNO) {
                    //fill array if the length less Number of Objects in level
                    if (movableHealthArray.length < LevelObjectsNO) {
                        for (var i = movableHealthArray.length ; i < LevelObjectsNO; i++) {
                            movableHealthArray[i] = CreateMovableHealthObject(i);
                        }
                    } else {
                        for (var i = LevelObjectsNO; i < movableHealthArray.length; i++) {
                            if (movableHealthArray[i] != "del") {
                                movableHealthArray[i].Destroy();
                            }
                        }
                    }
                    movableHealthArray.length = LevelObjectsNO;
                    for (var i = 0; i < movableHealthArray.length; i++) {
                        //decrease radius every Second
                        movableHealthArray[i].Radious--;
                        //check if radius less radius of Center Object destroy this Object :20 for demo
                        if (movableHealthArray[i].Radious <= 20) {
                            movableHealthArray[i].Destroy();      //destroy this object
                            movableHealthArray[i] = CreateMovableHealthObject(i);//Create new Object in same index
                        } else if (movableHealthArray[i] == "del") {
                            //replace "del" keyword to New Object
                            //"del" assign to this object in case he Hit Myship
                            //he already had been destroyed in collision Function
                            movableHealthArray[i] = CreateMovableHealthObject(i);
                        }
                    }
                }
                //--------end


                //--------Triangle health Objects
                function CreateTriangleHealthObject(index) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    //40: width of object no paypass circle ,90: this object appear in Outer Orbit
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 40, container.radius - 90);
                    var obj = new TriangleHealth(pos.X, pos.Y, index, pos.Radius, 1);
                    obj.Create();
                    return obj;
                }
                function ManageTriangleHealthObjects(LevelObjectsNO) {
                    //fill array if the length less Number of Objects in level
                    if (triangleHeathArray.length < LevelObjectsNO) {
                        for (var i = triangleHeathArray.length ; i < LevelObjectsNO; i++) {
                            triangleHeathArray[i] = CreateTriangleHealthObject(i);
                        }
                    } else {
                        for (var i = LevelObjectsNO; i < triangleHeathArray.length; i++) {
                            if (triangleHeathArray[i] != "del") {
                                triangleHeathArray[i].Destroy();
                            }
                        }
                    }
                    triangleHeathArray.length = LevelObjectsNO;
                    for (var i = 0; i < triangleHeathArray.length; i++) {
                        //decrease radius every Second
                        triangleHeathArray[i].LifeTime--;
                        //check if radius less radius of Center Object destroy this Object :20 for demo
                        if (triangleHeathArray[i].LifeTime <= 0) {
                            triangleHeathArray[i].Destroy();      //destroy this object
                            triangleHeathArray[i] = CreateTriangleHealthObject(i);//Create new Object in same index
                        } else if (triangleHeathArray[i] == "del") {
                            //replace "del" keyword to New Object
                            //"del" assign to this object in case he Hit Myship
                            //he already had been destroyed in collision Function
                            triangleHeathArray[i] = CreateTriangleHealthObject(i);
                        }
                    }
                }
                //--------end


                //--------Sleep Enemy Objects
                function CreateSleepEnemyObject(index) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 40, container.radius - 232);
                    var obj = new SleepEnemy(pos.X, pos.Y, index, pos.Radius);
                    obj.Create();   //did't use set time out as the different in two interval time squence
                    return obj;
                }
                function ManageSleepEnemyObjects(LevelObjectsNO) {
                    //fill array if the length less Number of Objects in level
                    if (sleepEnemyArray.length < LevelObjectsNO) {
                        for (var i = sleepEnemyArray.length ; i < LevelObjectsNO; i++) {
                            sleepEnemyArray[i] = CreateSleepEnemyObject(i);
                        }
                    } else {
                        for (var i = LevelObjectsNO; i < sleepEnemyArray.length; i++) {
                            if (sleepEnemyArray[i] != "del") {
                                sleepEnemyArray[i].Destroy();
                            }
                        }
                    }
                    sleepEnemyArray.length = LevelObjectsNO;
                    for (var i = 0; i < sleepEnemyArray.length; i++) {
                        //decrease LifTime every Second
                        sleepEnemyArray[i].LifeTime--;
                        //check if lifetime <0 destroy this Object
                        if (sleepEnemyArray[i].LifeTime <= 0) {
                            sleepEnemyArray[i].Destroy();      //destroy this object
                            sleepEnemyArray[i] = CreateSleepEnemyObject(i);//Create new Object in same index
                        } else if (sleepEnemyArray[i] == "del") {
                            //replace "del" keyword to New Object
                            //"del" assign to this object in case he Hit Myship
                            //he already had been destroyed in collision Function
                            sleepEnemyArray[i] = CreateSleepEnemyObject(i);
                        }
                    }
                }
                //--------end

                //--------Movable Enemy Objects
                function CreateMovableEnemyObject(index) {
                    //get Random Point X , Y in Circle With maxRadius and minRadius
                    //40: width of object no paypass circle ,90: this object appear in Outer Orbit
                    var pos = GetRandomPoint(container.X, container.Y, container.radius - 40, container.radius - 90);
                    var obj = new MovableEnemy(pos.X, pos.Y, index, pos.Radius, 1);
                    obj.Create();
                    return obj;
                }
                function ManageMovableEnemyObjects(LevelObjectsNO) {
                    //fill array if the length less Number of Objects in level
                    if (movableEnemyArray.length < LevelObjectsNO) {
                        for (var i = movableEnemyArray.length ; i < LevelObjectsNO; i++) {
                            movableEnemyArray[i] = CreateMovableEnemyObject(i);
                        }
                    } else {
                        for (var i = LevelObjectsNO; i < movableEnemyArray.length; i++) {
                            if (movableEnemyArray[i] != "del") {
                                movableEnemyArray[i].Destroy();
                            }
                        }
                    }
                    movableEnemyArray.length = LevelObjectsNO;
                    for (var i = 0; i < movableEnemyArray.length; i++) {
                        //decrease radius every Second
                        movableEnemyArray[i].LifeTime--;
                        //check if radius less radius of Center Object destroy this Object :20 for demo
                        if (movableEnemyArray[i].LifeTime <= 0) {
                            movableEnemyArray[i].Destroy();      //destroy this object
                            movableEnemyArray[i] = CreateMovableEnemyObject(i);//Create new Object in same index
                        } else if (movableEnemyArray[i] == "del") {
                            //replace "del" keyword to New Object
                            //"del" assign to this object in case he Hit Myship
                            //he already had been destroyed in collision Function
                            movableEnemyArray[i] = CreateMovableEnemyObject(i);
                        }
                    }
                }
                //--------end


                //-----------------------------------------StartGame
                //
                //start interval by one Second
                //decrease sessionTime--
                //decrease LifeTime for ALL objectS in container every interval
                //stop game when session time get to 0
                function StartGame() {
                    var StartSession = setInterval(function () {
                        //debugger;
                        sessionTime--;
                        var level = GetGameLevel();
                        //--------------------handle Life Time for each Object Every Interval
                        if (level == 1) {
                            //-------Sleep health:4
                            //ManageSleepHealthObjects(4);

                            //-------Sleep Enmey:2
                            // ManageSleepEnemyObjects(2);


                            //for deomoo
                            ManageMovableHealthObjects(3);

                        } else if (level == 2) {
                            //-------Sleep health:3
                            //ManageSleepHealthObjects(3);

                            //------- Movable health:3
                            ManageMovableHealthObjects(3);

                            //------- Triangle health:2
                            //ManageTriangleHealthObjects(2);

                            //-------- Movable Enemy:3
                            //ManageMovableEnemyObjects(3);

                            //-------Sleep Enmey:Delete sleep Enemy (argu=0 )
                            //ManageSleepEnemyObjects(0);

                        } else if (level == 3) {
                            //-------Sleep health:2
                            //ManageSleepHealthObjects(2);

                            //------- Movable health:2
                            ManageMovableHealthObjects(2);

                            //------- Triangle health:3
                           // ManageTriangleHealthObjects(3);

                            //-------- Movable Enemy:4
                           // ManageMovableEnemyObjects(4);

                        } else {
                            console.log("error : level is 0 or some thing");
                            throw new MyException("error : level is 0 or some thing is Wrong .. :( ");
                        }
                        console.log("Level " + level + "  : " + sessionTime);
                    }, 1000);

                    setTimeout(function () {
                        // unfortunately the Game Finish :(
                        //Good Luck
                        clearInterval(StartSession);
                        console.log("stop the game,, :(  ");
                        alert("The Game End :( ");
                    }, (container.RoundTime * 1000));

                }


                //---------------------for Demo controller with keyboard
                function MoveUp() {
                    myShipObj.Y -= 10;
                }
                function MoveDown() {
                    myShipObj.Y += 10;
                }
                function MoveRight() {
                    myShipObj.X += 10;
                }
                function MoveLeft() {
                    myShipObj.X -= 10;
                }
                window.addEventListener("keydown", function (e) {
                    switch (e.key) {
                        case "ArrowUp":
                            MoveUp();
                            break;
                        case "ArrowDown":
                            MoveDown();
                            break;
                        case "ArrowRight":
                            MoveRight();
                            break;
                        case "ArrowLeft":
                            MoveLeft();
                            break;
                        default:
                            break;
                    }
                    $("#" + myShipObj.Id).css("left", myShipObj.X);
                    $("#" + myShipObj.Id).css("top", myShipObj.Y);
                });
                //--------------------------Main
                function Main() {
                    sessionTime = (1 * 60);//second unit default (x * 60)
                    container.CreatCenter(); // replace center img with div Css ???????
                    container.RoundTime = sessionTime;
                    CreateMyShip(1); //create number of Ship for each player. our first version has one plaer
                    StartGame();    // Go Go, Be Ready.. the Game Started   :)
                    // Update container every .05 sec
                    //to reflect Moving objects in Container
                    //to detect collision
                    container.UpdateContainer();
                }
                Main();

            });
        </script>
</body>
</html>